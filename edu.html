<!DOCTYPE html>
<head>
  <title>Kayla A. Patel</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
  <link rel="stylesheet" type="text/css" href="main.css">
  <link href='https://fonts.googleapis.com/css?family=Source+Code+Pro:400,300|Source+Sans+Pro:400,600,700,300' rel='stylesheet' type='text/css'>

</head>
<!--browser icon-->
    <link rel="apple-touch-icon-precomposed" sizes="57x57" href="/Website/Images/beachicon/apple-touch-icon-57x57.png" />
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="./Images/beachicon/apple-touch-icon-114x114.png" />
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="./Images/beachicon/apple-touch-icon-72x72.png" />
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="./Images/beachicon/apple-touch-icon-144x144.png" />
    <link rel="apple-touch-icon-precomposed" sizes="60x60" href="./Images/beachicon/apple-touch-icon-60x60.png" />
    <link rel="apple-touch-icon-precomposed" sizes="120x120" href="./Images/beachicon/apple-touch-icon-120x120.png" />
    <link rel="apple-touch-icon-precomposed" sizes="76x76" href="./Images/beachicon/apple-touch-icon-76x76.png" />
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="./Images/beachicon/apple-touch-icon-152x152.png" />
    <link rel="icon" type="image/png" href="./Images/beachicon/favicon-196x196.png" sizes="196x196" />
    <link rel="icon" type="image/png" href="./Images/beachicon/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/png" href="./Images/beachicon/favicon-32x32.png" sizes="32x32" />
    <link rel="icon" type="image/png" href="./Images/beachicon/favicon-16x16.png" sizes="16x16" />
    <link rel="icon" type="image/png" href="./Images/beachicon/favicon-128.png" sizes="128x128" />
    <meta name="application-name" content="&nbsp;"/>
    <meta name="msapplication-TileColor" content="#FFFFFF" />
    <meta name="msapplication-TileImage" content="mstile-144x144.png" />
    <meta name="msapplication-square70x70logo" content="mstile-70x70.png" />
    <meta name="msapplication-square150x150logo" content="mstile-150x150.png" />
    <meta name="msapplication-wide310x150logo" content="mstile-310x150.png" />
    <meta name="msapplication-square310x310logo" content="mstile-310x310.png" />

</head>

<body>
<div class="container">
  <nav class="navbar navbar-default" id="navbarKP">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>                        
      </button>
    </div>
    <div class="collapse navbar-collapse" id="myNavbar">
      <ul class="nav navbar-nav">
        <li><a href="index.html">HOME</a></li>
        <li><a href="mapsandprojects.html">MAPS AND PROJECTS</a></li>
        <li><a href="./docs/Resume_March2016.pdf" sizes="16x16" target="_blank">RESUME</a></li>  
      </ul>
      <ul class="nav navbar-nav navbar-right" id="name">
        <li><a href="#">KAYLA A. PATEL</a></li>
      </ul>
    </div>
  </div>
</nav>
<div class="container-fluid">
<h2>Educational attainment of 18 to 24 year olds</h2>   
<h4>Percent of young adult population at each education level per county<hr></h4>

<p>The map below shows the education level of 18 to 24 year olds in 2014. The data comes from the American Community Survey five year estimates. Different education levels can be turned on and off based on user interests. When two or more levels are turned on the county is symbolized by the level with the maximum value in that county. The four levels of education are less than a high school diploma, a high school diploma (or an equivalent), an associate’s degree or some college, and a bachelor’s degree or higher.<br><br>

I relied <i>heavily</i> on Nathan Yau's Flowing Data’s <u><a href="http://flowingdata.com/2015/02/19/make-an-interactive-map-with-category-filters/"target="_blank">tutorial</a></u> to make this map. I’m new to interactive data visualizations and D3, and despite the dataset being main/only difference between my map and the tutorial, creating this map still proved to be challenging and a great learning experience. Along with the turtorial, Mike Bodstock's choropleth map <u><a href="https://bl.ocks.org/mbostock/4060606"target="_blank">example</a></u> also helped me get a handle on this and play around with different ways to create the map. I used R to wrangle the data into the format that I wanted (thanks again to Flowing Data for those R tutorials) and D3 to visualize it.<hr></p>

<div id="map" class="col-xs-12">

<div id="metrics">
    <div id="instruct"></div>
    <div id="edu">
        <!--<h4><strong>Education Level of 18 to 24 year olds</strong></h4>-->
        <ul>
        <li data-metric="t_lhs" class="selected t_lhs">Less than HS</li>
        <li data-metric="t_hs" class="selected t_hs">High School Degree</li>
        <li data-metric="t_asd" class="selected t_asd">Associate's Degree</li>
        <li data-metric="t_ba" class="selected t_ba">Bachelor's Degree</li>
        </ul>
    </div>
  
</div><!-- @end #metrics -->    
</div>

<div id="tooltip" class="tooltip">
    <h3 class="name"></h3>
    <div data-metric="t_lhs" class="line">
        <div class="t_lhs symbol"></div> Less than HS 
        <div class="moe_lhs_val moe"></div>
        <div class="t_lhs_val val"></div>
    </div>
    <div data-metric="t_hs" class="line">
        <div class="t_hs symbol"></div> High School Degree
        <div class="moe_hs_val moe"></div>
        <div class="t_hs_val val"></div>
    </div>
    <div data-metric="t_asd" class="line">
        <div class="t_asd symbol"></div> Associate's Degree
        <div class="moe_asd_val moe"></div>
        <div class="t_asd_val val"></div>
    </div>
    <div data-metric="t_ba" class="line">
        <div class="t_ba symbol"></div> Bachelor's Degree
        <div class="moe_ba_val moe"></div> 
        <div class="t_ba_val val"></div>
    </div>

</div>
</div>

<div class="container-fluid"><hr>
  <p>The map gives a sense of the geographic distribution of the general education level of young adults throughout the U.S. It makes it pretty clear that most young adults have made their way through high school and have gone beyond. Not surprisingly, the areas where the highest level of educational attainment for the majority of people is less than a high school degree tend to be in more rural areas, whereas people with the associate's degree or some college tend to live around cities.<br><br>

  In the two counties I have spent the majority of my life in - Worcester and Middlesex, MA  - the majority of young adults have their associates degree or some college, which makes sense due to the age of the population examined here and the close proximity of colleges in and near the counties. </p><br><br>

  <footer id="footer">
      <p>KAYLA.A.PATEL@GMAIL.COM  |  
    <a href="https://www.linkedin.com/in/kaylapatel">LINKEDIN</a>  |  
    <a href="https://github.com/paylakatel">GITHUB
    </a>  |  
    <a href="https://twitter.com/paylakatel" target="_blank">TWITTER</a>
    </a></p>
  </footer>

</div>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
<script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
<script src="http://d3js.org/d3.v3.min.js"></script>
<script src="http://d3js.org/queue.v1.min.js"></script>
<script src="http://d3js.org/topojson.v1.min.js"></script>
<script>

var width = 960,
    height = 600,
    center = [width / 2, height / 2],
    defaultFill = "#e0e0e0";

var baseColors = { 
    "t_lhs": d3.scale.linear().domain([0,60]).range(["#ffffff", "#f75a00"]).interpolate(d3.interpolateLab),
    "t_hs": d3.scale.linear().domain([0,60]).range(["#ffffff", "#99B900"]).interpolate(d3.interpolateLab),
    "t_asd": d3.scale.linear().domain([0,60]).range(["#ffffff", "#21a4a2"]).interpolate(d3.interpolateLab),
    "t_ba": d3.scale.linear().domain([0,70]).range(["#ffffff", "#834e71"]).interpolate(d3.interpolateLab),
};

var eduId = d3.map();

var projection = d3.geo.albersUsa()
    .scale(1280)
    .translate([width / 2, height / 2]);

var path = d3.geo.path()
    .projection(projection);

var zoom = d3.behavior.zoom()
    .scaleExtent([1, 8])
    .on("zoom", move);

var svg = d3.select("body #map").append("svg")
    .attr("width", width)
    .attr("height", height)
  .append("g")
    .call(zoom);
svg.on("wheel.zoom", null);
svg.on("mousewheel.zoom", null);

svg.append("rect")
    .attr("class", "overlay")
    .attr("width", width)
    .attr("height", height);
    
var g = svg.append("g");

    
var tooltip = d3.select("#tooltip")
 .attr("class", "tooltip")
 .style("opacity", 0);

var CURR_SELECT = ["t_lhs", "t_hs", "t_asd", "t_ba"];

queue()
    .defer(d3.json, "data/us.json")
    .defer(d3.csv, "data/edu-18to24-2014.csv", typeAndSet)
    .await(ready);


function ready(error, us, edu) {

    g.append("g")
        .attr("class", "counties")
        .selectAll("path")
          .data(topojson.feature(us, us.objects.counties).features)
        .enter().append("path")
          .attr("d", path)
          
          .on("mouseover", function(d) {
               d3.select(this).classed("selected", true);
               tooltip.transition().duration(100)
                 .style("opacity", 1)
               if (d3.event.pageX > (width - 200)) {
                   tooltip.style("left", (d3.event.pageX - 210) + "px");
               } else {
                   tooltip.style("left", (d3.event.pageX + 20) + "px")
                        .style("top", (d3.event.pageY -30) + "px");
               }
               if (d3.event.pageY > (height - 150)) {
                   tooltip.style("top", (d3.event.pageY -140) + "px");
               } else {
                   tooltip.style("top", (d3.event.pageY -30) + "px");
               }
               
               tooltip.select(".name").text(eduId.get(d.id)['name']);
               tooltip.select(".t_lhs_val.val").text(d3.round(eduId.get(d.id)["t_lhs"]) + "%")
               tooltip.select(".t_hs_val.val").text(d3.round(eduId.get(d.id)["t_hs"]) + "%")
               tooltip.select(".t_asd_val.val").text(d3.round(eduId.get(d.id)["t_asd"]) + "%")
               tooltip.select(".t_ba_val.val").text(d3.round(eduId.get(d.id)["t_ba"]) + "%")
               
               tooltip.select(".moe_lhs_val.moe").html("&plusmn;" + eduId.get(d.id)["moe_lhs"] + "%")
               tooltip.select(".moe_hs_val.moe").html("&plusmn;" + eduId.get(d.id)["moe_hs"] + "%")
               tooltip.select(".moe_asd_val.moe").html("&plusmn;" + eduId.get(d.id)["moe_asd"] + "%")
               tooltip.select(".moe_ba_val.moe").html("&plusmn;" + eduId.get(d.id)["moe_ba"] + "%")
             })
          .on("mouseout", function() {
              d3.select(this).classed("selected", false);
              tooltip.transition().duration(300)
                .style("opacity", 0);
              });

    g.append("path")
        .datum(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; }))
        .attr("class", "states")
        .attr("d", path);
    
    updateClasses();
        
    d3.selectAll("#metrics li")
        .on("click", function() {
            var item = d3.select(this);
            if (item.classed("selected")) {
                item.attr("class", "");
                removeFromArray(CURR_SELECT, item.attr("data-metric"));
                
            } else {
                item.classed("selected " + item.attr("data-metric"), true);
                CURR_SELECT.push(item.attr("data-metric"));
            }

            updateClasses();
        });


    // Zoom buttons
    svg.selectAll(".button")
        .data(['zoom_in', 'zoom_out'])
      .enter()
        .append("g")
          .attr("id", function(d){return d})
          .attr("class", "button")
          .attr({x: 20, width: 20, height: 20})
        .append("rect")
            .attr("y", function(d,i) { return 20 + 25*i })
            .attr({x: 20, width: 20, height: 20})
            .attr("border", 1)
            .style("stroke", "#000000");
    // Plus button
    svg.select("#zoom_in")
      .append("line")
        .attr({x1: 25, y1: 30, x2: 35, y2: 30 })
        .attr("stroke", "#000000")
        .attr("stroke-width", "2px");
    svg.select("#zoom_in")
      .append("line")
        .attr({x1: 30, y1: 25, x2: 30, y2: 35 })
        .attr("stroke", "#000000")
        .attr("stroke-width", "2px");
    // Minus button
    svg.select("#zoom_out")
      .append("line")
        .attr({x1: 25, y1: 55, x2: 35, y2: 55 })
        .attr("stroke", "#000000")
        .attr("stroke-width", "2px");


    svg.selectAll(".button")
      .on("click", function() {
          d3.event.preventDefault();
          
          var scale = zoom.scale(),
              extent = zoom.scaleExtent(),
              translate = zoom.translate(),
              x = translate[0], y = translate[1],
              factor = (this.id === 'zoom_in') ? 2 : 1/2,
              target_scale = scale * factor;
          
          var clamped_target_scale = Math.max(extent[0], Math.min(extent[1], target_scale));
            if (clamped_target_scale != target_scale){
                target_scale = clamped_target_scale;
                factor = target_scale / scale;
            }

            // Center each vector, stretch, then put back
            x = (x - center[0]) * factor + center[0];
            y = (y - center[1]) * factor + center[1];
            
            // Transition to the new view over 350ms
            d3.transition().duration(350).tween("zoom", function () {
                var interpolate_scale = d3.interpolate(scale, target_scale),
                    interpolate_trans = d3.interpolate(translate, [x,y]);
                return function (t) {
                    zoom.scale(interpolate_scale(t))
                        .translate(interpolate_trans(t));
                    svg.call(zoom.event);
                };
            });
      });
      
}
    
  
function typeAndSet(d) {
    
    d.t_lhs = +d.t_lhs;
    d.t_hs = +d.t_hs;
    d.t_asd = +d.t_asd;
    d.t_ba = +d.t_ba;
    d.HC01_EST_VC12 = +d.HC01_EST_VC12;
    d.HC01_EST_VC13 = +d.HC01_EST_VC13;
    d.HC01_EST_VC14 = +d.HC01_EST_VC14;
    
    d.HC01_MOE_VC04 = +d.HC01_MOE_VC04;
    d.HC01_MOE_VC05 = +d.HC01_MOE_VC05;
    d.HC01_MOE_VC10 = +d.HC01_MOE_VC10;
    d.HC01_MOE_VC11 = +d.HC01_MOE_VC11;
    d.HC01_MOE_VC12 = +d.HC01_MOE_VC12;
    d.HC01_MOE_VC13 = +d.HC01_MOE_VC13;
    d.HC01_MOE_VC14 = +d.HC01_MOE_VC14;
    eduId.set(d.FIPS, d);
    
}

function updateClasses() {
    if (CURR_SELECT.length > 0) {
        svg.selectAll(".counties path")
            .attr("fill", function(d) { return colorByGreatest(d.id) })
          // .attr("class", function(d) { return classByGreatest(d.id); })
          // .attr("opacity", function(d) { return opacityByGreatest(d.id); });
    } else {
        svg.selectAll(".counties path")
          .attr("class", "")
          .attr("fill", defaultFill);
    }
}

function colorByGreatest(FIPS) {
    
    var countyObject = eduId.get(FIPS);

    if (typeof countyObject !== "undefined") {
        var values = [];
        for (var i = 0; i < CURR_SELECT.length; i++) {
            values.push(countyObject[CURR_SELECT[i]]);
        }
        var maxValue = d3.max(values);
        var maxIndex = values.indexOf(maxValue);
        var metric = CURR_SELECT[maxIndex];
        return baseColors[metric](maxValue);
    } 
    
    else {
        return "#ffffff";
    }
    
}


// function classByGreatest(FIPS) {
//     var countyObject = commuteById.get(FIPS);
// 
//     if (typeof countyObject !== "undefined") {
//         var values = [];
//         for (var i = 0; i < CURR_SELECT.length; i++) {
//             values.push(countyObject[CURR_SELECT[i]]);
//         }
//         var maxIndex = values.indexOf(d3.max(values));
//         return CURR_SELECT[maxIndex];
//     } 
//     
//     else {
//         return "NODATA";
//     }
// }

/*function opacityByGreatest(FIPS) {
     var countyObject = eduId.get(FIPS);

     if (typeof countyObject !== "undefined") {
         var values = [];
         for (var i = 0; i < CURR_SELECT.length; i++) {
             values.push(countyObject[CURR_SELECT[i]]);
         }
        return opacityScale(d3.max(values));
     } 
     
     else {
         return 0;
     }
 }*/

function zoomIn() {
    zoom.scale(zoom.scale()*2);
    move();
}

function move() {
  var t = d3.event.translate,
      s = d3.event.scale;
  t[0] = Math.min(width * (s - 1), Math.max(width * (1 - s), t[0]));
  t[1] = Math.min(height * (s - 1), Math.max(height * (1 - s), t[1]));
  zoom.translate(t);
  g.style("stroke-width", 1 / s).attr("transform", "translate(" + t + ")scale(" + s + ")");
}

function clicked(d) {
  var x, y, k;

  if (d && centered !== d) {
    var centroid = path.centroid(d);
    x = centroid[0];
    y = centroid[1];
    k = 4;
    centered = d;
  } else {
    x = width / 2;
    y = height / 2;
    k = 1;
    centered = null;
  }

  g.selectAll("path")
      .classed("active", centered && function(d) { return d === centered; });

  g.transition()
      .duration(750)
      .attr("transform", "translate(" + width / 2 + "," + height / 2 + ")scale(" + k + ")translate(" + -x + "," + -y + ")")
      .style("stroke-width", 1.5 / k + "px");
}



function removeFromArray(arr) {
    var what, a = arguments, L = a.length, ax;
    while (L > 1 && arr.length) {
        what = a[--L];
        while ((ax= arr.indexOf(what)) !== -1) {
            arr.splice(ax, 1);
        }
    }
    return arr;
}


d3.select(self.frameElement).style("height", height + "px");
</script>