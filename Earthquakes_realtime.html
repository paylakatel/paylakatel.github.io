<!DOCTYPE html>
<html>
  <meta content="text/html;charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <link href='https://fonts.googleapis.com/css?family=Open+Sans+Condensed:700,300|Crimson+Text' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" type="text/css" href="style.css">
  <script
    src="https://maps.googleapis.com/maps/api/js?libraries=visualization">
  </script>
  <script type ="text/javascript">
      var map, points, arrmarkers, weight_points, act_heat, mag_heat, heat_colors, mapOptions, place, mag, infowindow;

      points = []; 
      weight_points = [];
      arrmarkers = [];
      heat_colors = ['rgba(127,205,187,0)','rgb(65,182,196)','rgb(29,145,192)','rgb(34,94,168)','rgb(37,52,148)','rgb(8,29,88)'];

      function initialize() {         
        //style array for custom style
        var styles = [{"featureType":"road","elementType":"geometry","stylers":[{"visibility":"off"}]},{"featureType":"poi","elementType":"geometry","stylers":[{"visibility":"off"}]},{"featureType":"landscape","elementType":"geometry","stylers":[{"color":"#fffffa"}]},{"featureType":"water","stylers":[{"lightness":50}]},{"featureType":"road","elementType":"labels","stylers":[{"visibility":"off"}]},{"featureType":"transit","stylers":[{"visibility":"off"}]},{"featureType":"administrative","elementType":"geometry","stylers":[{"lightness":40}]}]
        //custom style map opbect
        var mapCustomStyle = new google.maps.StyledMapType(styles, {name: 'Custom'});
          
        var mapOptions = {
            zoom: 2,
            center: new google.maps.LatLng(17, -5),
            mapTypeId: google.maps.MapTypeId.TERRAIN,
            mapTypeControlOptions: {
                style: google.maps.MapTypeControlStyle.HORIZONAL_BAR,
                position: google.maps.ControlPosition.RIGHT_TOP,
                },
          };
        
        map = new google.maps.Map(document.getElementById("map"),
          mapOptions);
        
        map.mapTypes.set('map_style', mapCustomStyle);
        
        map.setOptions({styles: styles});

        // Create a <script> tag and set the USGS URL as the source.
        var script = document.createElement('script');
        script.src = 'http://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/4.5_week.geojsonp';
        document.getElementsByTagName('head')[0].appendChild(script);
      
      infowindow = new google.maps.InfoWindow();

      };

        
      function eqfeed_callback(results) {

        for (var i = 0; i < results.features.length; i++) {
          var place = results.features[i].properties.place;
          var coords = results.features[i].geometry.coordinates;
          var latLng = new google.maps.LatLng(coords[1],coords[0]);
          var magnitude = results.features[i].properties.mag;
          function geticon(magnitude) {
            if (magnitude <= 5) {
              return 'https://maps.google.com/mapfiles/ms/icons/ltblue-dot.png';
            }
            else if (magnitude <= 8) {
              return 'https://maps.google.com/mapfiles/ms/icons/blue-dot.png'
            }
            else {
              return 'https://maps.google.com/mapfiles/ms/icons/purple-dot.png'
            }
          }
          var markers = new google.maps.Marker({
            position: latLng,
            map: map,
            icon: geticon(magnitude),
          });
          arrmarkers.push(markers);

          (function(markers, place, magnitude) {
          // Attaching a click event to the current marker
          google.maps.event.addListener(markers, "click", function(e) {
            infowindow.setContent("Location: " + place + "<br>" + "Magnitude: " + magnitude);
            infowindow.open(map, markers);
          });


          })(markers, place, magnitude);

        };

        var points = [];
        for (var i = 0; i < results.features.length; i++) {
          var coords = results.features[i].geometry.coordinates;
          var latLng = new google.maps.LatLng(coords[1], coords[0]);
          points.push(latLng);
        }
        act_heat = new google.maps.visualization.HeatmapLayer({
          data: points,
          dissipating: false,
          gradient: heat_colors,
          map: null,
        });

        var weight_points = [];
        for (var i = 0; i < results.features.length; i++) {
          var coords = results.features[i].geometry.coordinates;
          var latLng = new google.maps.LatLng(coords[1], coords[0]);
          var magnitude = results.features[i].properties.mag;
          var weightedLoc = {
            location: latLng,
            weight: Math.pow(2, magnitude)
          };
          weight_points.push(weightedLoc);
        }
        mag_heat = new google.maps.visualization.HeatmapLayer({
          data: weight_points,
          dissipating: false,
          gradient: heat_colors,
          map: null
        });
      };

      function act_heatmap() {
        if (arrmarkers) {
          for (var i = 0, n = arrmarkers.length; i < n; ++i) {
            arrmarkers[i].setMap(null);
          }
        }
        mag_heat.setMap(null);
        act_heat.setMap(act_heat.getMap() ? null : map)
      };

      function mag_heatmap() {
        if (arrmarkers) {
          for (var i = 0, n = arrmarkers.length; i < n; ++i) {
            arrmarkers[i].setMap(null);
          }
        }
        act_heat.setMap(null);
        mag_heat.setMap(mag_heat.getMap() ? null : map)
      };

      function locations() {
        act_heat.setMap(null);
        mag_heat.setMap(null);
        if (arrmarkers) {
          for (var i = 0, n = arrmarkers.length; i < n; ++i) {
            arrmarkers[i].setMap(map);
          }
        }
      };

      google.maps.event.addDomListener(window, 'load', initialize)

    </script>

  <!--browser icon-->
    <link rel="apple-touch-icon-precomposed" sizes="57x57" href="/Website/Images/beachicon/apple-touch-icon-57x57.png" />
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="./Images/beachicon/apple-touch-icon-114x114.png" />
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="./Images/beachicon/apple-touch-icon-72x72.png" />
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="./Images/beachicon/apple-touch-icon-144x144.png" />
    <link rel="apple-touch-icon-precomposed" sizes="60x60" href="./Images/beachicon/apple-touch-icon-60x60.png" />
    <link rel="apple-touch-icon-precomposed" sizes="120x120" href="./Images/beachicon/apple-touch-icon-120x120.png" />
    <link rel="apple-touch-icon-precomposed" sizes="76x76" href="./Images/beachicon/apple-touch-icon-76x76.png" />
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="./Images/beachicon/apple-touch-icon-152x152.png" />
    <link rel="icon" type="image/png" href="./Images/beachicon/favicon-196x196.png" sizes="196x196" />
    <link rel="icon" type="image/png" href="./Images/beachicon/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/png" href="./Images/beachicon/favicon-32x32.png" sizes="32x32" />
    <link rel="icon" type="image/png" href="./Images/beachicon/favicon-16x16.png" sizes="16x16" />
    <link rel="icon" type="image/png" href="./Images/beachicon/favicon-128.png" sizes="128x128" />
    <meta name="application-name" content="&nbsp;"/>
    <meta name="msapplication-TileColor" content="#FFFFFF" />
    <meta name="msapplication-TileImage" content="mstile-144x144.png" />
    <meta name="msapplication-square70x70logo" content="mstile-70x70.png" />
    <meta name="msapplication-square150x150logo" content="mstile-150x150.png" />
    <meta name="msapplication-wide310x150logo" content="mstile-310x150.png" />
    <meta name="msapplication-square310x310logo" content="mstile-310x310.png" />
  </head>
  <body>

    <div class="wrapper">
      <header>
        <div class="nav">
          <ul>
            <li><a href="index.html">HOME</a></li>
            <li><a href="mapsandprojects.html">MAPS AND PROJECTS</a>
            <li><a href="./docs/Resume_Oct2015.pdf" sizes="16x16">RESUME</a></li>
            <li id="name">Kayla A. Patel</li>
            </ul>
          </div>
      </header>
      <div><h2>4.5+ Magnitude earthquakes occuring in the past week</h2>
        <p>This map shows the locations and magnitudes of earthquakes occurring in the past week that had a magnitude greater than 4.5. I wanted to experiment with mapping realtime data, and fortunately USGS makes it fairly easy to pull recent earthquake off their website and throw it on a map. They provide realtime geojson feeds which can be pulled directly from their website, so the map date updates automatically.  </p>
      </div>
    </div> 

  <div id="map"></div>      

  <div class="buttons_panel">
    <ul>
        <li><button class="button" onclick="act_heatmap()">Activity Heat Map</button></li>
        <li><button class="button" onclick="mag_heatmap()">Magnitude Heat Map</button></li>
        <li><button class="button" onclick="locations()">Locations</button></li>
        <li><img src='https://maps.google.com/mapfiles/ms/icons/ltblue-dot.png'></img>4.5-5 Magnitude</li>
        <li><img src='https://maps.google.com/mapfiles/ms/icons/blue-dot.png'></img>5-8 Magnitude</li>
        <li><img src='https://maps.google.com/mapfiles/ms/icons/purple-dot.png'></img>>8 Magnitude</li>
    </ul>      
  </div>

<div class="wrapper">
  <div><p>The map defaults to have the location of each earthquake shown, and you can click a marker to find out the location and magnitude of the specific event.<br><br>The "Activity Heatmap" button will show a heat map based on earthquake activity in the past week, highlighting areas experiencing many earthquakes regardless of the magnitude.<br><br>The "Magnitude Heat Map" button will show a heat map weighted by the magnitude of each event, highlighting areas with high intensity activity regardless of the number of earthquakes that occurred.</p></div>

  <div class="push"></div>
  <br>
    <div class="footer">
      kayla.a.patel@gmail.com | 
      <a href="https://www.linkedin.com/in/kaylapatel">LinkedIn</a> | 
    <a href="https://github.com/paylakatel">GitHub
      </a> | 
    </div> 
 </div>

</body>
</html>